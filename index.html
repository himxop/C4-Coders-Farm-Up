import React, { useState, useCallback } from 'react';

// --- Helper Components & Data ---

// Icon components (inline SVGs to avoid external dependencies)
const SunIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-8 w-8 text-yellow-400"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg>;
const LeafIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-6 w-6 mr-2 text-green-500"><path d="M11 20A7 7 0 0 1 4 13H2a10 10 0 0 0 10 10z"></path><path d="M2 13h2a7 7 0 0 1 7 7v-2a10 10 0 0 0-10-10z"></path><path d="M12 2A10 10 0 0 0 2 12h2a7 7 0 0 1 7-7z"></path></svg>;
const BrainCircuitIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-6 w-6 mr-2 text-blue-500"><path d="M12 2a10 10 0 0 0-10 10c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94 0-1.1.39-1.99 1.03-2.69a3.6 3.6 0 0 1 .1-2.64s.84-.27 2.75 1.02a9.58 9.58 0 0 1 5 0c1.91-1.29 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69 0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85v2.72c0 .27.16.59.67.5A10 10 0 0 0 22 12c0-5.52-4.48-10-10-10Z"></path></svg>;
const DollarSignIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-5 w-5 mr-2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>;
const MessageSquareIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-5 w-5 mr-2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>;
const UploadCloudIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-10 w-10 mx-auto text-gray-400"><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path><path d="M12 12v9"></path><path d="m16 16-4-4-4 4"></path></svg>;

// --- Mock Data ---
const marketPrices = [
    { name: 'Wheat (गेहूँ)', price: '₹2,275', change: '+2.1%', trend: 'up' },
    { name: 'Paddy (धान)', price: '₹2,183', change: '-0.5%', trend: 'down' },
    { name: 'Soybean (सोयाबीन)', price: '₹4,650', change: '+1.8%', trend: 'up' },
    { name: 'Cotton (कपास)', price: '₹7,120', change: '+3.2%', trend: 'up' },
];

const communityTips = [
    { user: 'Ramesh K.', tip: 'Using neem oil spray is a great organic way to control pests on vegetable crops. Try it!' },
    { user: 'Sunita Devi', tip: 'Soil testing before planting is very important. My yield for corn increased by 15% this year after balancing nutrients.' },
    { user: 'Vikram Singh', tip: 'For better water retention in sandy soils, I recommend adding compost and mulch. It really helped during the dry spell.' },
];

// --- Core Feature: Disease Detection ---

function DiseaseDetection() {
    const [fileName, setFileName] = useState('');
    const [isAnalyzing, setIsAnalyzing] = useState(false);
    const [result, setResult] = useState(null);

    const handleFileChange = (e) => {
        if (e.target.files && e.target.files[0]) {
            const file = e.target.files[0];
            setFileName(file.name);
            setIsAnalyzing(true);
            setResult(null);

            // --- SIMULATE AI ANALYSIS ---
            // This timeout mimics a real model processing the image.
            setTimeout(() => {
                // In a real app, you would get this from your AI model's API response.
                const possibleResults = [
                    { disease: 'Corn Common Rust', confidence: '95%', recommendation: 'Apply a foliar fungicide. Ensure proper plant spacing for better air circulation.', healthy: false },
                    { disease: 'Potato Early Blight', confidence: '92%', recommendation: 'Remove and destroy infected leaves. Use copper-based fungicides as a preventive measure.', healthy: false },
                    { disease: 'Tomato Leaf Mold', confidence: '88%', recommendation: 'Improve greenhouse ventilation and reduce humidity. Prune lower leaves to increase airflow.', healthy: false },
                    { disease: 'Healthy Plant', confidence: '98%', recommendation: 'Your plant appears healthy. Continue standard watering and nutrient schedules.', healthy: true },
                ];
                const randomResult = possibleResults[Math.floor(Math.random() * possibleResults.length)];
                setResult(randomResult);
                setIsAnalyzing(false);
            }, 2500);
        }
    };

    const handleReset = () => {
        setFileName('');
        setResult(null);
        setIsAnalyzing(false);
    };

    return (
        <div className="bg-white p-8 rounded-2xl shadow-lg border border-gray-200 transition-all duration-300 hover:shadow-2xl">
            <div className="flex items-center mb-4">
                <LeafIcon />
                <h3 className="text-2xl font-bold text-gray-800">Crop Disease Detection</h3>
            </div>
            <p className="text-gray-600 mb-6">Upload an image of a plant leaf, and our AI will identify potential diseases and provide recommendations.</p>

            {!result && !isAnalyzing && (
                 <div className="relative border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-green-500 transition-colors">
                    <input
                        type="file"
                        id="file-upload"
                        className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                        accept="image/*"
                        onChange={handleFileChange}
                    />
                    <label htmlFor="file-upload" className="cursor-pointer">
                        <UploadCloudIcon />
                        <p className="mt-2 text-sm text-gray-600">
                            <span className="font-semibold text-green-600">Click to upload</span> or drag and drop
                        </p>
                        <p className="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                    </label>
                </div>
            )}

            {fileName && <p className="text-center my-4 text-gray-700">File: <span className="font-semibold">{fileName}</span></p>}
            
            {isAnalyzing && (
                 <div className="flex flex-col items-center justify-center p-8">
                     <div className="w-16 h-16 border-4 border-t-4 border-green-500 border-t-transparent rounded-full animate-spin"></div>
                     <p className="mt-4 text-lg text-gray-700">Analyzing Image...</p>
                 </div>
            )}

            {result && (
                <div className={`p-6 rounded-lg transition-all duration-500 ${result.healthy ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'} border`}>
                    <h4 className="font-bold text-xl mb-2">{result.healthy ? 'Analysis Result: Healthy' : 'Analysis Result: Disease Detected'}</h4>
                    <div className={`text-lg font-semibold ${result.healthy ? 'text-green-800' : 'text-red-800'}`}>{result.disease}</div>
                    <div className="text-sm text-gray-600 mb-4">Confidence: {result.confidence}</div>
                    <h5 className="font-semibold text-gray-800 mb-1">Recommendation:</h5>
                    <p className="text-gray-700">{result.recommendation}</p>
                    <button onClick={handleReset} className="mt-6 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
                        Analyze Another Image
                    </button>
                </div>
            )}
        </div>
    );
}


// --- Main App Component ---

export default function App() {
    return (
        <div className="bg-gray-50 font-sans">
            {/* Header & Navigation */}
            <header className="bg-white shadow-sm sticky top-0 z-50">
                <nav className="container mx-auto px-6 py-4 flex justify-between items-center">
                    <div className="text-2xl font-bold text-green-600">
                        Farm-Up
                    </div>
                    <div className="hidden md:flex space-x-8 items-center">
                        <a href="#home" className="text-gray-600 hover:text-green-600">Home</a>
                        <a href="#about" className="text-gray-600 hover:text-green-600">About</a>
                        <a href="#services" className="text-gray-600 hover:text-green-600">Services</a>
                        <a href="#dashboard" className="text-gray-600 hover:text-green-600">Dashboard</a>
                        <a href="#contact" className="text-gray-600 hover:text-green-600">Contact</a>
                    </div>
                     <button className="md:hidden text-gray-600">
                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                    </button>
                </nav>
            </header>

            {/* Hero Section */}
            <section id="home" className="relative h-[60vh] md:h-[80vh] bg-cover bg-center" style={{ backgroundImage: "url('https://images.unsplash.com/photo-1499529112087-3cb3b73cec95?q=80&w=1974&auto=format&fit=crop')" }}>
                <div className="absolute inset-0 bg-black bg-opacity-50"></div>
                <div className="container mx-auto px-6 h-full flex flex-col justify-center items-start relative z-10">
                    <h1 className="text-4xl md:text-6xl font-extrabold text-white leading-tight">Empowering Farmers <br /> with AI Technology</h1>
                    <p className="text-lg md:text-xl text-gray-200 mt-4 max-w-xl">Get real-time insights on crop health, yield prediction, and market prices to maximize your harvest.</p>
                    <a href="#services" className="mt-8 bg-green-600 text-white font-bold py-3 px-8 rounded-full hover:bg-green-700 transition-transform hover:scale-105">
                        Try Disease Detection
                    </a>
                </div>
            </section>

            {/* About Us Section */}
            <section id="about" className="py-20">
                <div className="container mx-auto px-6">
                    <div className="text-center mb-12">
                         <h2 className="text-4xl font-bold text-gray-800">About Farm-Up</h2>
                         <p className="text-lg text-gray-600 mt-2">We are C4 Coders, on a mission to revolutionize agriculture.</p>
                    </div>
                     <div className="grid md:grid-cols-2 gap-12 items-center">
                        <div>
                            <img src="https://images.unsplash.com/photo-1586771107445-d3ca888e2c05?q=80&w=2070&auto=format&fit=crop" alt="Farmers" className="rounded-2xl shadow-xl"/>
                        </div>
                        <div className="text-gray-700 text-lg space-y-4">
                           <p>Farm-Up is our solution for the Smart India Hackathon, designed to bring the power of AI directly to the hands of Indian farmers. We believe that by providing accessible, data-driven insights, we can help increase yields, reduce losses, and build a more sustainable future for agriculture.</p>
                           <p>Our platform combines advanced machine learning with real-time data from government APIs like ISRO and IMD to provide a comprehensive smart farming companion.</p>
                        </div>
                    </div>
                </div>
            </section>

             {/* Services Section - NOW INTERACTIVE! */}
            <section id="services" className="py-20 bg-white">
                <div className="container mx-auto px-6">
                    <div className="text-center mb-12">
                         <h2 className="text-4xl font-bold text-gray-800">Our Core Service</h2>
                         <p className="text-lg text-gray-600 mt-2">The heart of Farm-Up. Experience our AI in action.</p>
                    </div>
                    <div className="max-w-4xl mx-auto">
                        <DiseaseDetection />
                    </div>
                    <div className="grid md:grid-cols-3 gap-8 mt-16 text-center">
                        <div className="p-6">
                            <BrainCircuitIcon />
                            <h3 className="font-bold text-xl mt-2">Yield Prediction</h3>
                            <p className="text-gray-600 mt-2">Our models analyze weather and soil data to forecast your crop yield.</p>
                        </div>
                        <div className="p-6">
                            <LeafIcon />
                            <h3 className="font-bold text-xl mt-2">Fertilizer Recommendation</h3>
                            <p className="text-gray-600 mt-2">Get smart recommendations on the right fertilizer and dosage for your crops.</p>
                        </div>
                         <div className="p-6">
                            <SunIcon />
                            <h3 className="font-bold text-xl mt-2">Crop Recommendation</h3>
                            <p className="text-gray-600 mt-2">Discover the most profitable crops to plant based on your soil and local climate.</p>
                        </div>
                    </div>
                </div>
            </section>


            {/* NEW: Farmer's Dashboard */}
            <section id="dashboard" className="py-20">
                <div className="container mx-auto px-6">
                    <div className="text-center mb-12">
                         <h2 className="text-4xl font-bold text-gray-800">Farmer's Dashboard</h2>
                         <p className="text-lg text-gray-600 mt-2">Your daily snapshot for smart farming decisions.</p>
                    </div>
                    <div className="grid lg:grid-cols-3 gap-8">
                        {/* Weather Card */}
                        <div className="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                             <h3 className="font-bold text-xl mb-4">Today's Weather (Gopalpur)</h3>
                             <div className="flex items-center justify-between">
                                 <div>
                                     <p className="text-5xl font-bold text-gray-800">32°C</p>
                                     <p className="text-gray-600">Mostly Sunny</p>
                                 </div>
                                 <SunIcon />
                             </div>
                             <div className="mt-6 space-y-2 text-gray-700">
                                 <p><strong>Humidity:</strong> 65%</p>
                                 <p><strong>Wind:</strong> 12 km/h W</p>
                                 <p><strong>Precipitation:</strong> 5%</p>
                             </div>
                        </div>

                        {/* Market Prices Card */}
                        <div className="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                             <h3 className="font-bold text-xl mb-4">Live Mandi Prices</h3>
                             <div className="space-y-3">
                                {marketPrices.map((item, index) => (
                                    <div key={index} className="flex justify-between items-center">
                                        <p className="font-semibold text-gray-800">{item.name}</p>
                                        <div className="text-right">
                                             <p className="font-bold">{item.price}</p>
                                             <span className={`text-sm ${item.trend === 'up' ? 'text-green-600' : 'text-red-600'}`}>{item.change}</span>
                                        </div>
                                    </div>
                                ))}
                             </div>
                        </div>

                         {/* Community Tips Card */}
                        <div className="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                             <h3 className="font-bold text-xl mb-4">Community Tips</h3>
                             <div className="space-y-4">
                                {communityTips.map((item, index) => (
                                    <div key={index} className="border-l-4 border-green-500 pl-4">
                                        <p className="text-gray-700">"{item.tip}"</p>
                                        <p className="text-right text-sm text-gray-500 mt-1">- {item.user}</p>
                                    </div>
                                ))}
                             </div>
                        </div>

                    </div>
                </div>
            </section>

            {/* Contact Section */}
            <section id="contact" className="py-20 bg-white">
                 <div className="container mx-auto px-6">
                    <div className="text-center mb-12">
                         <h2 className="text-4xl font-bold text-gray-800">Get In Touch</h2>
                         <p className="text-lg text-gray-600 mt-2">Have questions? We'd love to hear from you.</p>
                    </div>
                     <div className="max-w-2xl mx-auto">
                        <form className="space-y-6">
                            <input type="text" placeholder="Your Name" className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"/>
                             <input type="email" placeholder="Your Email" className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"/>
                            <textarea placeholder="Your Message" rows="5" className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                            <button type="submit" className="w-full bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition-colors">Send Message</button>
                        </form>
                    </div>
                </div>
            </section>

            {/* Footer */}
            <footer className="bg-gray-800 text-white">
                <div className="container mx-auto px-6 py-8 text-center">
                    <p className="text-xl font-bold">Farm-Up by C4 Coders</p>
                    <p className="mt-2 text-gray-400">Smart India Hackathon 2025</p>
                </div>
            </footer>
        </div>
    );
}
